sudo: false
language: java
jdk:
  - oraclejdk8
before_install:
  - export MAVEN_OPTS="-Xmx512M -XX:MaxPermSize=256M"

# whitelist
branches:
  only:
    - ecat3.2-prod
    - ecat3.2-test
    - /^ecat3.2-.*$/ # any dev branch

script:
  - if [[ $TRAVIS_BRANCH =~ ^ecat3.2-.*$ ]];then
    export BRANCH="ecat3.2-dev";
    else
    export BRANCH=$TRAVIS_BRANCH;
    fi
  - mvn install -DskipTests=true

addons:
  artifacts:
    s3_region: "ap-southeast-2"
    paths:
      - $TRAVIS_BUILD_DIR/web/target/geonetwork.war
    target_paths: $BRANCH
    